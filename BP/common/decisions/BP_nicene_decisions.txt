issue_henotikon_decision = {
	title = issue_henotikon_decision
	picture = "gfx/interface/illustrations/decisions/decision_major_religion.dds"
	
	desc = issue_henotikon_decision_desc
	selection_tooltip = issue_henotikon_decision_tooltip
	major = yes
	
	ai_check_interval = 120
	
	is_shown = {
		is_ruler = yes
		is_landed = yes
		faith = faith:nicene #Nicene Only
		NOT = {  #Can only do it once.
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:issued_henotikon
			}
		}
		highest_held_title_tier > 4 #Only Emperors
		has_title = title:e_byzantium
	}
	
	is_valid = {
		piety >= 1250
		completely_controls = title:c_byzantion
		completely_controls = title:c_alexandria
		OR = {
			completely_controls = title:c_antiocheia
			completely_controls = title:c_jerusalem
		}
		is_at_war = no
	}
	
	is_valid_showing_failures_only = {
		is_capable_adult = yes
		is_imprisoned = no
		is_independent_ruler = yes
	}
	
	cost = {
		gold = 100
		piety = 1250
		prestige = 500
	}
	
	effect = {
		custom_tooltip = issue_the_henotikon_decision_effect_tooltip
		show_as_tooltip = { issue_henotikon_effects = yes }
		
		#The issuer cannot revoke the Henotikon
		add_character_flag = { flag = henotikon_issuer }
		
		save_scope_as = henotikon_issuer
		##Events
		
		#Inform issuer about Henotikon
		trigger_event = nicene_decision_events.0001
		
		#Inform ecumenical christians about the Henotikon and give them options
		every_ruler = {
			limit = {
				NOT = { this = scope:henotikon_issuer }
				OR = {
					is_landed = yes
					is_clergy = yes
				}
				AND = {
					faith.religion = faith:nicene.religion
					faith = { has_doctrine = special_doctrine_ecumenical_christian }
				}
			}
			trigger_event = nicene_decision_events.0002
		}
		#Fire event for realm priests as well
		every_living_character = {
			limit = {
				NOT = { this = scope:henotikon_issuer }
				is_clergy = yes
				AND = {
					faith.religion = faith:nicene.religion
					faith = { has_doctrine = special_doctrine_ecumenical_christian }
				}
			}
			trigger_event = nicene_decision_events.0002
		}
		#Inform non-ecumenical christians (players only)
		every_player = {
			limit = {
				NOT = { this = scope:henotikon_issuer }
				is_within_diplo_range = { CHARACTER = scope:henotikon_issuer }
				AND = {
					religion = faith:nicene.religion
					NOT = { faith = { has_doctrine = special_doctrine_ecumenical_christian } }
				}
			}
			trigger_event = nicene_decision_events.0003
		}
		#Inform non-christians (players only)
		every_player = {
			limit = {
				NOT = { this = scope:henotikon_issuer }
				is_within_diplo_range = { CHARACTER = scope:henotikon_issuer }
				NOT = { religion = faith:nicene.religion }
			}
			trigger_event = nicene_decision_events.0004
		}
		 
	#Can only be done once
	add_to_global_variable_list = {
		name = unavailable_unique_decisions
		target = flag:issued_henotikon
	}
}

	ai_potential = {
		always = yes
	}

	ai_will_do = {
		base = 100
	}
}#end:issue_henotikon_decision

decision_revoke_henotikon = {
	title = revoke_henotikon_decision
	picture = "gfx/interface/illustrations/decisions/decision_major_religion.dds"
	
	desc = revoke_henotikon_decision_desc
	selection_tooltip = revoke_henotikon_decision_tooltip
	major = yes
	
	ai_check_interval = 120
	
	#Can see if emperor level title and nicene religion
	is_shown = {
		is_ruler = yes
		is_landed = yes
		faith = faith:nicene
		is_target_in_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:issued_henotikon
		}
		NOT = { #Can only do it once.
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:revoked_henotikon
			}
		}
		highest_held_title_tier > 4 #Only Emperors
		has_title = title:e_byzantium
		#The issuer may not revoke the henotikon, nor do so shortly after taking the throne
		NOT = { has_character_flag = henotikon_issuer }
		NOT = { has_character_flag = changed_henotikon_state }
	}
	
	#Similar conditions to issuing; requires at least 3 holy sites and not at war
	is_valid = {
		piety >= 250
		is_at_war = no
	}
	
	is_valid_showing_failures_only = {
		is_capable_adult = yes
		is_imprisoned = no
		is_independent_ruler = yes
	}
	
	cost = {
		gold = 100
		piety = 250
		prestige = 500
	}
	
	effect = {
		#custom_tooltip = revoke_henotikon_decision_tooltip
		show_as_tooltip = { henotikon_revoked_effects = yes }
		
		save_scope_as = henotikon_revoker
		
		#Events
		#Inform issuer about Henotikon
		trigger_event = nicene_decision_events.0021
		
		#Inform everyone else about Henotikon
		every_player = {
			limit = {
				NOT = { this = scope:henotikon_revoker }
				is_within_diplo_range = { CHARACTER = scope:henotikon_revoker }
			}
			trigger_event = nicene_decision_events.0022
		}
		
	#Can only be done once
	add_to_global_variable_list = {
		name = unavailable_unique_decisions
		target = flag:revoked_henotikon
	}
}

	ai_potential = {
		always = yes
	}

	ai_will_do = {
		base = 10000
	}
}#end:decision_revoke_henotikon

decision_embrace_henotikon = {
	title = embrace_henotikon_decision
	picture = "gfx/interface/illustrations/decisions/decision_minor_religion.dds"
	
	desc = embrace_henotikon_decision_desc
	selection_tooltip = embrace_henotikon_decision_tooltip
	
	ai_check_interval = 60
	
	#Can see if clergy or a ruler who is *not* the Byzantine emperor who is part of an ecumenical faith
	#Also can't have the required trait
	is_shown = {
		OR = {
			is_ruler = yes
			is_clergy = yes
		}
		faith = {
			has_doctrine = doctrine_christian_henotikon_issued
			has_doctrine = special_doctrine_ecumenical_christian
		}
		NOT = { has_title = title:e_byzantium }
		NOT = { has_trait = embraced_henotikon }
	}
	
	is_valid = {
		piety >= 50
		is_at_war = no
		NOT = { has_character_flag = changed_henotikon_state }
	}
	
	is_valid_showing_failures_only = {
		is_capable_adult = yes
		is_imprisoned = no
	}
	
	cost = {
		gold = 50
		piety = 50
	}
	
	effect = {
		custom_tooltip = embrace_henotikon_decision_tooltip
		#show_as_tooltip = { henotikon_embraced_effects = yes }
		
		remove_trait = repudiated_henotikon
		add_trait = embraced_henotikon
		
		#Can only be done once every 5 years
		add_character_flag = {
			flag = changed_henotikon_state
			years = 5
		}
	}

	ai_potential = {
		always = yes
	}

	ai_will_do = {
		base = 10
			
			modifier = { #If I'm zealous I will refuse the Henotikon
				add = -500
				has_trait = zealous
			}
			
			modifier = { #If I'm independent clergy I will refuse the Henotikon
				add = -500
				AND = {
					NOT = { top_liege = { has_title = title:e_byzantium } }
					is_clergy = yes
				}
			}
			
			modifier = { #If I'm independent secular I will likely refuse the Henotikon
				add = -5
				AND = {
					NOT = { top_liege = { has_title = title:e_byzantium } }
					is_clergy = no
				}
			}
			
			modifier = { #If I'm not a zealous vassal of e_byzantium, I'll likely accept the Henotikon
				add = 80
				AND = {
					is_vassal_or_below_of = scope:henotikon_issuer
					NOT = { has_trait = zealous }
				}
			}
	}
}#end:decision_embrace_henotikon

decision_repudiate_henotikon = {
	title = repudiate_henotikon_decision
	picture = "gfx/interface/illustrations/decisions/decision_minor_religion.dds"
	
	desc = repudiate_henotikon_decision
	selection_tooltip = repudiate_henotikon_decision_tooltip
	
	ai_check_interval = 60
	
	#Can see if clergy or a ruler who is *not* the Byzantine emperor who is part of an ecumenical faith
	#Also can't have the required trait
	is_shown = {
		OR = {
			is_ruler = yes
			is_clergy = yes
		}
		faith = {
			has_doctrine = doctrine_christian_henotikon_issued
			has_doctrine = special_doctrine_ecumenical_christian
		}
		NOT = { has_title = title:e_byzantium }
		NOT = { has_trait = repudiated_henotikon }
	}
	
	is_valid = {
		piety >= 50
		is_at_war = no
		NOT = { has_character_flag = changed_henotikon_state }
	}
	
	is_valid_showing_failures_only = {
		is_capable_adult = yes
		is_imprisoned = no
	}
	
	cost = {
		gold = 50
		piety = 50
	}
	
	effect = {
		custom_tooltip = repudiated_henotikon_decision_tooltip
		#show_as_tooltip = { henotikon_repudiated_effects = yes }
		
		remove_trait = embraced_henotikon
		add_trait = repudiated_henotikon
		
		#Can only be done once every 5 years
		add_character_flag = {
			flag = changed_henotikon_state
			years = 5
		} 
	}

	ai_potential = {
		always = yes
	}

	ai_will_do = {
		base = 90
			
			modifier = { #If I'm a vassal but not zealous, I'll rarely refuse the henotikon
				add = -80
				AND = {
					NOT = { top_liege = { has_title = title:e_byzantium } }
					NOT = { has_trait = zealous }
				}
			}
			
			modifier = { #If I'm independent clergy I will refuse the Henotikon
				add = 500
				AND = {
					NOT = { top_liege = { has_title = title:e_byzantium } }
					is_clergy = yes
				}
			}
			
			modifier = { #If I'm independent secular I will likely refuse the Henotikon
				add = 10
				AND = {
					NOT = { top_liege = { has_title = title:e_byzantium } }
					is_clergy = no
				}
			}
			
			modifier = { #If I'm zealous I will refuse the Henotikon
				add = 500
				has_trait = zealous
			}
	}
}#end:decision_embrace_henotikon
