#Events run from the yearly_pulse on_action
namespace = yearly_bp_religion

#Clears Henotikon if nothing remains to support it:
#    * If no Byzantine Emperor, void henotikon
#    * If all Nicene Emperors have less than 2 holy sites, void henotikon

#If no byzantine emperor and not yet revoked OR looses control of holy sites, void the henotikon
yearly_bp_religion.0002 = {
	hidden = yes
	trigger = {
		#Henotikon Issued but not revoked
		is_target_in_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:issued_henotikon
		}
		NOT = {
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:revoked_henotikon
			}
		}
		#Either nobody is byzantine emperor or he doesn't control enough holy sites
		OR = {
			NOT = { any_ruler = { has_title = title:e_byzantium } }
			
			#Byzantine Emperor w/o required holy sites
			any_ruler = {
				has_title = title:e_byzantium
				NOT = {
					AND = {
						completely_controls = title:c_byzantion
						completely_controls = title:c_alexandria
						OR = {
							completely_controls = title:c_antiocheia
							completely_controls = title:c_jerusalem
						}
					}
				}
			}
		}
	}
	
	immediate = {
		add_to_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:revoked_henotikon
		}
		
		every_player = { #Triggers even w/o nicene players
			trigger_event = nicene_decision_events.0031
		}
	}
}