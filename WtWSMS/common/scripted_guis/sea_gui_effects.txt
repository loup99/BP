#TODO: Add net size variable to faiths/cultures as well

open_minority_tooltip = {
	scope = county
	
	effect = {
		root = {
			set_variable = {
				name = the_county_temp
				value = root
			}
			
			##### CULTURE CASES #####
			if = {
				limit = { culture = { has_a_culture_blending_tradition_trigger = yes } }
				set_variable = the_county_has_a_culture_blending_tradition
			}
			if = {
				limit = { has_a_rough_terrain_province_trigger = yes }
				set_variable = the_county_has_a_rough_terrain_province
			}
			if = {
				limit = { has_variable_list = culture_minorities_small }
				every_in_list = {
					variable = culture_minorities_small
					this = {
						set_variable = the_culture_is_small
						if = {
							limit = { has_reduced_weight_in_rough_terrain_trigger = yes }
							set_variable = the_culture_has_reduced_weight_in_rough_terrain
						}
					}
				}
				#Calculate the net size of each culture; should mirror culture_small_minority_weight_value
				every_in_list = {
					variable = culture_minorities_small
					this = {
						set_variable = {
							name = net_size
							value = base_small_minority_weight
						}
						if = {
							limit = { root = { has_variable = the_county_has_a_culture_blending_tradition } }
							change_variable = {
								name = net_size
								multiply = tradition_culture_blending_multiplier
							}
						}
						if = {
							limit = {
								this = { has_variable = the_culture_has_reduced_weight_in_rough_terrain }
								root = { has_variable = the_county_has_a_rough_terrain_province }
							}
							change_variable = {
								name = net_size
								multiply = tradition_rough_terrain_diversity_multiplier
							}
						}
					}
				}
			}
			if = {
				limit = { has_variable_list = culture_minorities_large }
				every_in_list = {
					variable = culture_minorities_large
					this = {
						if = {
							limit = { has_reduced_weight_in_rough_terrain_trigger = yes }
							set_variable = the_culture_has_reduced_weight_in_rough_terrain
						}
					}
				}
				#Calculate the net size of each culture; should mirror culture_large_minority_weight_value
				every_in_list = {
					variable = culture_minorities_large
					this = {
						set_variable = {
							name = net_size
							value = base_large_minority_weight
						}
						if = {
							limit = { root = { has_variable = the_county_has_a_culture_blending_tradition } }
							change_variable = {
								name = net_size
								multiply = tradition_culture_blending_multiplier
							}
						}
						if = {
							limit = {
								this = { has_variable = the_culture_has_reduced_weight_in_rough_terrain }
								root = { has_variable = the_county_has_a_rough_terrain_province }
							}
							change_variable = {
								name = net_size
								multiply = tradition_rough_terrain_diversity_multiplier
							}
						}
					}
				}
			}
			
			##### FAITH CASES #####
			if = {
				limit = { faith = { is_dharmic_faith_trigger = yes } }
				set_variable = the_county_has_dharmic_faith
			}
			if = {
				limit = { culture = { has_a_religion_blending_tradition_trigger = yes } }
				set_variable = the_county_has_a_religion_blending_tradition
			}
			if = {
				limit = { has_variable_list = faith_minorities_small }
				every_in_list = {
					variable = faith_minorities_small
					this = {
						set_variable = the_faith_is_small
						if = {
							limit = { has_reduced_weight_in_dharmic_counties_trigger = yes }
							set_variable = the_faith_has_reduced_weight_in_dharmic_counties
						}
					}
				}
				#Calculate the net size of each culture; should mirror faith_small_minority_weight_value
				every_in_list = {
					variable = faith_minorities_small
					this = {
						set_variable = {
							name = net_size
							value = base_small_minority_weight
						}
						if = {
							limit = {
								root = { has_variable = the_county_has_dharmic_faith }
								this = { has_variable = the_faith_has_reduced_weight_in_dharmic_counties }
							}
							change_variable = {
								name = net_size
								multiply = dharmic_minorities_in_dharmic_counties_multiplier
							}
						}
						if = {
							limit = { root = { has_variable = the_county_has_a_religion_blending_tradition } }
							change_variable = {
								name = net_size
								multiply = tradition_religion_blending_multiplier
							}
						}
					}
				}
			}
			if = {
				limit = { has_variable_list = faith_minorities_large }
				every_in_list = {
					variable = faith_minorities_large
					this = {
						if = {
							limit = { has_reduced_weight_in_dharmic_counties_trigger = yes }
							set_variable = the_faith_has_reduced_weight_in_dharmic_counties
						}
					}
				}
				#Calculate the net size of each culture; should mirror faith_large_minority_weight_value
				every_in_list = {
					variable = faith_minorities_large
					this = {
						set_variable = {
							name = net_size
							value = base_large_minority_weight
						}
						if = {
							limit = {
								root = { has_variable = the_county_has_dharmic_faith }
								this = { has_variable = the_faith_has_reduced_weight_in_dharmic_counties }
							}
							change_variable = {
								name = net_size
								multiply = dharmic_minorities_in_dharmic_counties_multiplier
							}
						}
						if = {
							limit = { root = { has_variable = the_county_has_a_religion_blending_tradition } }
							change_variable = {
								name = net_size
								multiply = tradition_religion_blending_multiplier
							}
						}
					}
				}
			}
		}
	}
}
close_minority_tooltip = {
	scope = county
	
	effect = {
		root = {
			if = {
				limit = { has_variable = the_county_temp }
				remove_variable = the_county_temp
			}
			
			##### CULTURE CASES #####
			if = {
				limit = { has_variable = has_a_culture_blending_tradition_trigger }
				remove_variable = the_county_has_a_culture_blending_tradition
			}
			if = {
				limit = { has_variable = has_a_rough_terrain_province_trigger }
				remove_variable = the_county_has_a_rough_terrain_province
			}
			if = {
				limit = { has_variable_list = culture_minorities_small }
				every_in_list = {
					variable = culture_minorities_small
					this = {
						remove_variable = the_culture_is_small
						if = {
							limit = { has_variable = has_reduced_weight_in_rough_terrain_trigger }
							remove_variable = the_culture_has_reduced_weight_in_rough_terrain
						}
					}
				}
			}
			if = {
				limit = { has_variable_list = culture_minorities_large }
				every_in_list = {
					variable = culture_minorities_small
					this = {
						if = {
							limit = { has_variable = has_reduced_weight_in_rough_terrain_trigger }
							remove_variable = the_culture_has_reduced_weight_in_rough_terrain
						}
					}
				}
			}
			
			##### FAITH CASES #####
			if = {
				limit = { has_variable = the_county_has_dharmic_faith }
				remove_variable = the_county_has_dharmic_faith
			}
			if = {
				limit = { has_variable_list = faith_minorities_small }
				every_in_list = {
					variable = faith_minorities_small
					this = {
						if = {
							limit = { has_variable = the_faith_has_reduced_weight_in_dharmic_counties }
							remove_variable = the_faith_has_reduced_weight_in_dharmic_counties
						}
					}
				}
			}
			if = {
				limit = { has_variable_list = faith_minorities_large }
				every_in_list = {
					variable = faith_minorities_large
					this = {
						remove_variable = the_faith_is_small
						if = {
							limit = { has_variable = the_faith_has_reduced_weight_in_dharmic_counties }
							remove_variable = the_faith_has_reduced_weight_in_dharmic_counties
						}
					}
				}
			}
		}
	}
}
