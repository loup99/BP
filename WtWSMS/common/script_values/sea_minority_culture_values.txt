culture_conversion_acceptance_impact = { #The smaller a culture is, the more upset it will be.
	subtract = {
		value = 1
		divide = {
			value = scope:county.culture.culture_number_of_counties
			min = 1
		}
		multiply = 15 #Same as used in grant above

		# Due to minority system
		divide = 3
		min = 0.1
		max = 5
	}
}
##### Changed from Vanilla vvvvv

#Generic values
minority_always_supported_value = 1000 #For things like Diasporic
majority_province_support_value = 10
large_minority_support_value = 2
large_minority_cost_value = 4
small_minority_support_value = 1
small_minority_cost_value = 2
#Other values

#small minority, large minority, majority; script value in case we want to change this
number_of_minority_levels = 3

#Assuming you know how many years Y you want a P% of a minority spread, you can 
#calculate as P = (1-X)^Y, for P the chance of minority spread
# So here's a quick look-up table:
#
#  P  |   X   |  Y  
#-----|-------|-----
# 50% | 1.00% |  70 
# 50% | 2.73% |  25 
# 50% | 1.38% |  50 
# 50% | 12.9% |  05 
chance_of_minority_immigration_event_per_year = 100

chance_of_culture_minority_reduction_event_per_year = 12.9
chance_of_culture_minority_underfed_event_per_year = 2.73

chance_of_faith_minority_reduction_event_per_year = 12.9
chance_of_faith_minority_underfed_event_per_year = 2.73

chance_of_faith_majority_evangelization_event_per_year = 2.73

#Other Script Values
#County Scope
minority_capacity_of_county = {
	# Every county can support minorities as a function of its development; We will utilize the Lucas
	# Sequence Vn(1,−1) [the Lucas Numbers, a series related to the Fibonacci sequence]
	# 1, 3, 4, 7, 11, 18, 29, 47, 76 ...
	value = 1
	if = { #Only non-tribal counties should support more than one minority
		limit = { this = { any_province = { NOT = { has_holding_type = tribal_holding } } } }
		if = { limit = { this.development_level >= 04 } add = 1 }
		if = { limit = { this.development_level >= 07 } add = 1 }
		if = { limit = { this.development_level >= 11 } add = 1 }
		if = { limit = { this.development_level >= 18 } add = 1 }
		if = { limit = { this.development_level >= 29 } add = 1 }
		if = { limit = { this.development_level >= 47 } add = 1 }
		if = { limit = { this.development_level >= 76 } add = 1 }
	}
}
#County Scope
number_of_culture_minorities_in_county = {
	value = 0
	if = {
		limit = { this = { has_variable_list = culture_minorities_small } }
		this = {
			every_in_list = { variable = culture_minorities_small add = 1 }
		}
	}
	if = {
		limit = { this = { has_variable_list = culture_minorities_large } }
		this = { every_in_list = { variable = culture_minorities_large add = 2 } }
	}
}
#County Scope
number_of_faith_minorities_in_county = {
	this = { save_temporary_scope_as = the_county_temp }
	value = 0
	if = { #Small minorities
		limit = { this = { has_variable_list = faith_minorities_small } }
		this = {
			every_in_list = {
				variable = faith_minorities_small
				if = { #Indian faiths support greater plurality
					limit = { scope:the_county_temp.faith = { has_doctrine = eastern_hostility_doctrine } }
					if = { #Dharmic faiths support 50% more minorities, so long as they are Dharmic or Eastern Pagan
						limit = {
							OR = {
								scope:the_county_temp.faith = { has_doctrine = eastern_hostility_doctrine }
								scope:the_county_temp.faith = { has_doctrine = eastern_pagan_hostility_doctrine }
							}
						}
						add = 0.67
					}
					else = { add = 1 } #Non-Dharmic case
				}
				else = { add = 1 } #all other interactions
			}
		}
	}
	if = { #Large minorities
		limit = { this = { has_variable_list = faith_minorities_large } }
		this = {
			every_in_list = {
				variable = faith_minorities_large
				if = { #Indian faiths support greater plurality
					limit = { scope:the_county_temp.faith = { has_doctrine = eastern_hostility_doctrine } }
					if = { #Dharmic faiths support 50% more minorities, so long as they are Dharmic or Eastern Pagan
						limit = {
							OR = {
								scope:the_county_temp.faith = { has_doctrine = eastern_hostility_doctrine }
								scope:the_county_temp.faith = { has_doctrine = eastern_pagan_hostility_doctrine }
							}
						}
						add = 1.34
					}
					else = { add = 2 } #Non-Dharmic case
				}
				else = { add = 2 } #all other interactions
			}
		}
	}
	floor = yes #Because of fractional Dharmic values
}
#Culture Scope
support_of_a_culture_minority_in_county = {
	this = { save_temporary_scope_as = the_culture }
	value = 0
	#Determine how much is needed to feed this minority
	if = {
		limit = {
			scope:target_county = {
				has_variable_list = culture_minorities_large
				is_target_in_variable_list = { name = culture_minorities_large target = scope:the_culture }
			}
		}
		subtract = large_minority_cost_value
		#If there's no majority provinces on the map, it takes a bit more to keep large majorities going
		#this should encourage eventual disappearance of only thinly supported cultures; or at least
		#push them towards a minority status
		if = {
			limit = { NOT = { any_county = { this.culture = scope:the_culture } } }
			subtract = small_minority_cost_value
		}
	}
	if = {
		limit = {
			scope:target_county = {
				has_variable_list = culture_minorities_small
				is_target_in_variable_list = { name = culture_minorities_small target = scope:the_culture }
			}
		}
		subtract = small_minority_cost_value
		#If there's no large minorities on the map, it takes a bit more to keep small majorities going
		#this should encourage eventual disappearance of only thinly supported cultures; or at least
		#push them to be more concentrated
		if = {
			limit = {
				NOT = { any_county = { this.culture = scope:the_culture } }
				NOT = {
					any_county = {
						has_variable_list = culture_minorities_large
						is_target_in_variable_list = { name = culture_minorities_large target = scope:the_culture }
					}
				}
			}
			subtract = small_minority_cost_value
		}
	}
	#Determine how much is supporting this minority
	scope:target_county = {
		every_neighboring_county = {
			if = { #County with a majority population
				limit = { this.culture = scope:the_culture }
				add = majority_province_support_value
			}
			else_if = { #County with a directly-related population give a small amount of support
				limit = { this.culture = { the_culture_or_parent_is_trigger = { CULTURE = scope:the_culture } } }
				add = small_minority_support_value
			}
			else_if = { #County with a large minority
				limit = {
					has_variable_list = culture_minorities_large
					is_target_in_variable_list = { name = culture_minorities_large target = scope:the_culture }
				}
				add = large_minority_support_value
			}
			else_if = { #County with a small minority
				limit = {
					has_variable_list = culture_minorities_small
					is_target_in_variable_list = { name = culture_minorities_small target = scope:the_culture }
				}
				add = small_minority_support_value
			}
		}
		holder = {
			if = { #If the minority matches the ruler, it should not fade
				limit = { this.culture = scope:the_culture }
				add = minority_always_supported_value
				add = minority_always_supported_value #Even more-so than Diasporic
			}
		}
	}
	#Culture specific tradition effects
	scope:the_culture = {
		if = { #Colonizers/Hellenizers: Equivalent to having a large minority next to you
			limit = {
				OR = {
					has_cultural_tradition = tradition_colonizers
					has_cultural_tradition = tradition_colonizers_non_dlc
					has_cultural_tradition = tradition_hellenizers
					has_cultural_tradition = tradition_hellenizers_non_dlc
				}
			}
			add = large_minority_support_value
		}
		if = { #Romance/Hellenic/Levantine Culture: Equivalent to having a small minority next to you
			limit = {
				OR = {
					has_cultural_tradition = tradition_romance_culture
					has_cultural_tradition = tradition_romance_culture_non_dlc
					has_cultural_tradition = tradition_hellenic_culture
					has_cultural_tradition = tradition_hellenic_culture_non_dlc
					has_cultural_tradition = tradition_levantine_traditions
					has_cultural_tradition = tradition_levantine_traditions_non_dlc
				}
			}
			add = small_minority_support_value
		}
		if = { #Certain traditions imply being always supported if a minority
			limit = {
				AND = {
					has_cultural_tradition = tradition_diasporic
					NOT = { scope:target_county.culture = scope:the_culture }
				}
			}
			add = minority_always_supported_value
		}
	}
	multiply = -1.00
}
#County Scope
support_of_a_faith_minority_in_county = {
	this = { save_temporary_scope_as = the_faith }
	value = 0
	#Determine how much is needed to feed this minority
	if = {
		limit = {
			scope:target_county = {
				has_variable_list = faith_minorities_large
				is_target_in_variable_list = { name = faith_minorities_large target = scope:the_faith }
			}
		}
		subtract = large_minority_cost_value
		#If there's no majority provinces on the map, it takes a bit more to keep large majorities going
		#this should encourage eventual disappearance of only thinly supported cultures; or at least
		#push them towards a minority status
		if = {
			limit = { NOT = { any_county = { this.faith = scope:the_faith } } }
			subtract = small_minority_cost_value
		}
	}
	if = {
		limit = {
			scope:target_county = {
				has_variable_list = faith_minorities_small
				is_target_in_variable_list = { name = faith_minorities_small target = scope:the_faith }
			}
		}
		subtract = small_minority_cost_value
		#If there's no large minorities on the map, it takes a bit more to keep small majorities going
		#this should encourage eventual disappearance of only thinly supported cultures; or at least
		#push them to be more concentrated
		if = {
			limit = {
				NOT = { any_county = { this.faith = scope:the_faith } }
				NOT = {
					any_county = {
						has_variable_list = faith_minorities_large
						is_target_in_variable_list = { name = faith_minorities_large target = scope:the_faith }
					}
				}
			}
			subtract = small_minority_cost_value
		}
	}
	#Determine how much is supporting this minority
	scope:target_county = {
		every_neighboring_county = {
			if = { #County with a majority population
				limit = { this.faith = scope:the_faith }
				add = majority_province_support_value
			}
			else_if = { #County with a large minority
				limit = {
					has_variable_list = faith_minorities_large
					is_target_in_variable_list = { name = faith_minorities_large target = scope:the_faith }
				}
				add = large_minority_support_value
			}
			else_if = { #County with a small minority
				limit = {
					has_variable_list = faith_minorities_small
					is_target_in_variable_list = { name = faith_minorities_small target = scope:the_faith }
				}
				add = small_minority_support_value
			}
		}
		holder = {
			if = { #If the minority matches the ruler, it should not fade
				limit = { this.faith = scope:the_faith }
				add = minority_always_supported_value
				add = minority_always_supported_value #Even more so than other faiths
			}
		}
		if = { #Holy Site: Equivalent to having a large minority next to you
			limit = { any_barony = { is_holy_site_of = scope:the_faith } }
			add = large_minority_support_value
		}
	}
	#Certain doctrines/tenets bolster score
	scope:the_faith = {
		if = { #Autocephalous faiths are less likely to disappear if their associated cultures are present
			limit = { scope:the_faith = { has_doctrine = tenet_autocephaly } }
			if = {
				limit = {
					OR = {
						scope:target_county.culture = scope:the_faith.var:church_culture
						actor_is_faith_culture_or_child_culture_for_cultural_religions_DIRECT_trigger = {
								ACTOR = scope:target_county
								TARGET_FAITH = scope:the_faith
								VARIABLE = church_culture
						}
					}
				}
				add = majority_province_support_value
			}
			else_if = {
				limit = {
					has_variable_list = culture_minorities_large
					OR = {
						is_target_in_variable_list = {
							name = culture_minorities_large
							target = scope:the_faith.var:church_culture
						}
						any_in_list = {
							variable = culture_minorities_large
							actor_is_faith_culture_or_child_culture_for_cultural_religions_DIRECT_trigger = {
								ACTOR = scope:target_county
								TARGET_FAITH = scope:the_faith
								VARIABLE = church_culture
							}
						}
					}
				}
				add = large_minority_support_value
			}
			else_if = {
				limit = {
					has_variable_list = culture_minorities_small
					OR = {
						is_target_in_variable_list = {
							name = culture_minorities_small
							target = scope:the_faith.var:church_culture
						}
						any_in_list = {
							variable = culture_minorities_small
							actor_is_faith_culture_or_child_culture_for_cultural_religions_DIRECT_trigger = {
								ACTOR = scope:target_county
								TARGET_FAITH = scope:the_faith
								VARIABLE = church_culture
							}
						}
					}
				}
				add = large_minority_support_value
			}
		}
		if = { #Ethnic Religions faiths are less likely to disappear if their associated cultures are present
			limit = { scope:the_faith = { has_doctrine = tenet_ethnic_religion } }
			if = {
				limit = {
					OR = {
						scope:target_county.culture = scope:the_faith.var:ethnic_religion_culture
						actor_is_faith_culture_or_child_culture_for_cultural_religions_DIRECT_trigger = {
							ACTOR = scope:target_county
							TARGET_FAITH = scope:the_faith
							VARIABLE = ethnic_religion_culture
						}
					}
				}
				add = majority_province_support_value
				add = majority_province_support_value
			}
			else_if = {
				limit = {
					has_variable_list = culture_minorities_large
					OR = {
						is_target_in_variable_list = {
							name = culture_minorities_large
							target = scope:the_faith.var:ethnic_religion_culture
						}
						any_in_list = {
							variable = culture_minorities_large
							actor_is_faith_culture_or_child_culture_for_cultural_religions_DIRECT_trigger = {
								ACTOR = scope:target_county
								TARGET_FAITH = this
								VARIABLE = ethnic_religion_culture
							}
						}
					}
				}
				add = large_minority_support_value
				add = large_minority_support_value
			}
			else_if = {
				limit = {
					has_variable_list = culture_minorities_small
					OR = {
						is_target_in_variable_list = {
							name = culture_minorities_small
							target = scope:the_faith.var:ethnic_religion_culture
						}
						any_in_list = {
							variable = culture_minorities_small
							actor_is_faith_culture_or_child_culture_for_cultural_religions_DIRECT_trigger = {
								ACTOR = scope:target_county
								TARGET_FAITH = this
								VARIABLE = ethnic_religion_culture
							}
						}
					}
				}
				add = small_minority_support_value
				add = small_minority_support_value
			}
		}
		if = { #Jewish faiths are well protected so long as the county isn't Jewish
			limit = {
				this.religion = religion:judaism_religion
				NOT = { scope:target_county.religion = religion:judaism_religion }
			}
			add = majority_province_support_value
			add = majority_province_support_value
			add = majority_province_support_value
		}
	}
	multiply = -1.00
}
##### Changed from Vanilla ^^^^^
