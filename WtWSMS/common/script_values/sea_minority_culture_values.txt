culture_conversion_acceptance_impact = { #The smaller a culture is, the more upset it will be.
	subtract = {
		value = 1
		divide = {
			value = scope:county.culture.culture_number_of_counties
			min = 1
		}
		multiply = 15 #Same as used in grant above

		# Due to minority system
		divide = 3
		min = 0.1
		max = 5
	}
}
##### Changed from Vanilla vvvvv

#Assuming you know how many years Y you want a P% of a minority spread, you can 
#calculate as P = (1-X)^Y, for P the chance of minority spread
# So here's a quick look-up table:
#
#  P  |   X   |  Y  
#-----|-------|-----
# 50% | 1.00% |  70 
# 50% | 2.73% |  25 
# 50% | 1.38% |  50 
# 50% | 12.9% |  05 
chance_of_minority_immigration_event_per_year = 2.73

chance_of_culture_minority_reduction_event_per_year = 12.9
chance_of_culture_minority_underfed_event_per_year = 2.73

chance_of_faith_minority_reduction_event_per_year = 12.9
chance_of_faith_minority_underfed_event_per_year = 2.73

chance_of_faith_majority_evangelization_event_per_year = 2.73

chance_of_majority_growth_event_per_year = 1.38
chance_of_outward_immigration_event_per_year = 2.73

#Other Script Values
#County Scope
minority_capacity_of_county = {
	# Every county can support minorities as a function of its development; We will utilize the Lucas
	# Sequence Vn(1,−1) [the Lucas Numbers, a series related to the Fibonacci sequence]
	# 1, 3, 4, 7, 11, 18, 29, 47, 76 ...
	value = 1
	if = { #Only non-tribal counties should support more than one minority
		limit = { this = { any_province = { NOT = { has_holding_type = tribal_holding } } } }
		if = { limit = { this.development_level >= 04 } add = 1 }
		if = { limit = { this.development_level >= 07 } add = 1 }
		if = { limit = { this.development_level >= 11 } add = 1 }
		if = { limit = { this.development_level >= 18 } add = 1 }
		if = { limit = { this.development_level >= 29 } add = 1 }
		if = { limit = { this.development_level >= 47 } add = 1 }
		if = { limit = { this.development_level >= 76 } add = 1 }
	}
}
minority_capacity_of_county_culture = {
	value = minority_capacity_of_county
	if = { #Only non-tribal counties should support more than one minority
		limit = { this = { any_province = { NOT = { has_holding_type = tribal_holding } } } }
		# Egalitarian Ethos decreases minority capacity per development cut-off
		if = {
			limit = { this.culture = { has_cultural_pillar = ethos_egalitarian } }
			add = egalitarian_capacity_from_development
			if = { limit = { this.development_level >= 04 } add = egalitarian_capacity_from_development }
			if = { limit = { this.development_level >= 07 } add = egalitarian_capacity_from_development }
			if = { limit = { this.development_level >= 11 } add = egalitarian_capacity_from_development }
			if = { limit = { this.development_level >= 18 } add = egalitarian_capacity_from_development }
			if = { limit = { this.development_level >= 29 } add = egalitarian_capacity_from_development }
			if = { limit = { this.development_level >= 47 } add = egalitarian_capacity_from_development }
			if = { limit = { this.development_level >= 76 } add = egalitarian_capacity_from_development }
		}
		# Communal Ethos decreases minority capacity per development cut-off
		else_if = {
			limit = { this.culture = { has_cultural_pillar = ethos_communal } }
			if = { limit = { this.development_level >= 04 } subtract = communal_capacity_from_development }
			if = { limit = { this.development_level >= 07 } subtract = communal_capacity_from_development }
			if = { limit = { this.development_level >= 11 } subtract = communal_capacity_from_development }
			if = { limit = { this.development_level >= 18 } subtract = communal_capacity_from_development }
			if = { limit = { this.development_level >= 29 } subtract = communal_capacity_from_development }
			if = { limit = { this.development_level >= 47 } subtract = communal_capacity_from_development }
			if = { limit = { this.development_level >= 76 } subtract = communal_capacity_from_development }
		}
	}
	min = 1
	floor = yes
}
minority_capacity_of_county_faith = {
	value = minority_capacity_of_county
	if = { #Only non-tribal counties should support more than one minority
		limit = { this = { any_province = { NOT = { has_holding_type = tribal_holding } } } }
		# Pluralism decreases minority capacity per development cut-off
		if = {
			limit = { this.faith = { has_doctrine = doctrine_pluralism_pluralistic } }
			add = pluralistic_capacity_from_development
			if = { limit = { this.development_level >= 04 } add = pluralistic_capacity_from_development }
			if = { limit = { this.development_level >= 07 } add = pluralistic_capacity_from_development }
			if = { limit = { this.development_level >= 11 } add = pluralistic_capacity_from_development }
			if = { limit = { this.development_level >= 18 } add = pluralistic_capacity_from_development }
			if = { limit = { this.development_level >= 29 } add = pluralistic_capacity_from_development }
			if = { limit = { this.development_level >= 47 } add = pluralistic_capacity_from_development }
			if = { limit = { this.development_level >= 76 } add = pluralistic_capacity_from_development }
		}
		# Fundamentalism decreases minority capacity per development cut-off
		else_if = {
			limit = { this.faith = { has_doctrine = doctrine_pluralism_pluralistic } }
			add = fundamentalist_capacity_from_development
			if = { limit = { this.development_level >= 04 } add = fundamentalist_capacity_from_development }
			if = { limit = { this.development_level >= 07 } add = fundamentalist_capacity_from_development }
			if = { limit = { this.development_level >= 11 } add = fundamentalist_capacity_from_development }
			if = { limit = { this.development_level >= 18 } add = fundamentalist_capacity_from_development }
			if = { limit = { this.development_level >= 29 } add = fundamentalist_capacity_from_development }
			if = { limit = { this.development_level >= 47 } add = fundamentalist_capacity_from_development }
			if = { limit = { this.development_level >= 76 } add = fundamentalist_capacity_from_development }
		}
	}
	min = 1
	floor = yes
}
#County Scope
number_of_culture_minorities_in_county_weighted = {
	value = 0
	if = {
		limit = { this = { has_variable_list = culture_minorities_small } }
		this = {
			every_in_list = { variable = culture_minorities_small add = 1 }
		}
	}
	if = {
		limit = { this = { has_variable_list = culture_minorities_large } }
		this = { every_in_list = { variable = culture_minorities_large add = 2 } }
	}
}
#County Scope
number_of_faith_minorities_in_county_weighted = {
	this = { save_temporary_scope_as = the_county_temp }
	value = 0
	if = { #Small minorities
		limit = { this = { has_variable_list = faith_minorities_small } }
		this = {
			every_in_list = {
				variable = faith_minorities_small
				if = { #Indian faiths support greater plurality
					limit = { scope:the_county_temp.faith = { is_dharmic_faith_trigger = yes } }
					if = { #Dharmic faiths support 50% more minorities, so long as they are Dharmic or Eastern Pagan
						limit = { scope:the_county_temp.faith = { is_valid_dharmic_minority_cost_trigger = yes } }
						add = 0.67
					}
					else = { add = 1 } #Non-Dharmic case
				}
				else = { add = 1 } #all other interactions
			}
		}
	}
	if = { #Large minorities
		limit = { this = { has_variable_list = faith_minorities_large } }
		this = {
			every_in_list = {
				variable = faith_minorities_large
				if = { #Indian faiths support greater plurality
					limit = { scope:the_county_temp.faith = { is_dharmic_faith_trigger = yes } }
					if = { #Dharmic faiths support 50% more minorities, so long as they are Dharmic or Eastern Pagan
						limit = { scope:the_county_temp.faith = { is_valid_dharmic_minority_cost_trigger = yes } }
						add = 1.34
					}
					else = { add = 2 } #Non-Dharmic case
				}
				else = { add = 2 } #all other interactions
			}
		}
	}
	floor = yes #Because of fractional Dharmic values
}

### Minority Supports
#Note that the values are less than zero to keep the ordering algorithms simple
#Also, presumes the scope `the_county` has been set

#Culture Support Determination
support_of_a_culture_minority_in_county = {
	this = { save_temporary_scope_as = the_culture }
	value = support_of_a_minority_culture_generic
	### Additional, TC-specific features go before the "multiply = -1.00" line
	multiply = -1.00
}
#Faith Support Determination
support_of_a_faith_minority_in_county = {
	this = { save_temporary_scope_as = the_faith }
	value = support_of_a_minority_faith_generic
	### Additional, TC-specific features go before the "multiply = -1.00" line
	### New WtWSMS Features
	scope:the_faith = {
		if = { #Autocephalous faiths are less likely to disappear if their associated cultures are present
			limit = { scope:the_faith = { has_doctrine = tenet_autocephaly } }
			if = {
				limit = {
					OR = {
						scope:the_county.culture = scope:the_faith.var:church_culture
						actor_is_faith_culture_or_child_culture_for_cultural_religions_DIRECT_trigger = {
							ACTOR = scope:the_county
							TARGET_FAITH = scope:the_faith
							VARIABLE = church_culture
						}
					}
				}
				add = majority_province_support_value
			}
			else_if = {
				limit = {
					has_variable_list = culture_minorities_large
					OR = {
						is_target_in_variable_list = {
							name = culture_minorities_large
							target = scope:the_faith.var:church_culture
						}
						any_in_list = {
							variable = culture_minorities_large
							actor_is_faith_culture_or_child_culture_for_cultural_religions_DIRECT_trigger = {
								ACTOR = scope:the_county
								TARGET_FAITH = scope:the_faith
								VARIABLE = church_culture
							}
						}
					}
				}
				add = large_minority_support_value
			}
			else_if = {
				limit = {
					has_variable_list = culture_minorities_small
					OR = {
						is_target_in_variable_list = {
							name = culture_minorities_small
							target = scope:the_faith.var:church_culture
						}
						any_in_list = {
							variable = culture_minorities_small
							actor_is_faith_culture_or_child_culture_for_cultural_religions_DIRECT_trigger = {
								ACTOR = scope:the_county
								TARGET_FAITH = scope:the_faith
								VARIABLE = church_culture
							}
						}
					}
				}
				add = large_minority_support_value
			}
		}
		if = { #Ethnic Religions faiths are less likely to disappear if their associated cultures are present
			limit = { scope:the_faith = { has_doctrine = tenet_ethnic_religion } }
			if = {
				limit = {
					OR = {
						scope:the_county.culture = scope:the_faith.var:ethnic_religion_culture
						actor_is_faith_culture_or_child_culture_for_cultural_religions_DIRECT_trigger = {
							ACTOR = scope:the_county
							TARGET_FAITH = scope:the_faith
							VARIABLE = ethnic_religion_culture
						}
					}
				}
				add = majority_province_support_value
				add = majority_province_support_value
			}
			else_if = {
				limit = {
					has_variable_list = culture_minorities_large
					OR = {
						is_target_in_variable_list = {
							name = culture_minorities_large
							target = scope:the_faith.var:ethnic_religion_culture
						}
						any_in_list = {
							variable = culture_minorities_large
							actor_is_faith_culture_or_child_culture_for_cultural_religions_DIRECT_trigger = {
								ACTOR = scope:the_county
								TARGET_FAITH = this
								VARIABLE = ethnic_religion_culture
							}
						}
					}
				}
				add = large_minority_support_value
				add = large_minority_support_value
			}
			else_if = {
				limit = {
					has_variable_list = culture_minorities_small
					OR = {
						is_target_in_variable_list = {
							name = culture_minorities_small
							target = scope:the_faith.var:ethnic_religion_culture
						}
						any_in_list = {
							variable = culture_minorities_small
							actor_is_faith_culture_or_child_culture_for_cultural_religions_DIRECT_trigger = {
								ACTOR = scope:the_county
								TARGET_FAITH = this
								VARIABLE = ethnic_religion_culture
							}
						}
					}
				}
				add = small_minority_support_value
				add = small_minority_support_value
			}
		}
	}
	multiply = -1.00
}
##### Changed from Vanilla ^^^^^
