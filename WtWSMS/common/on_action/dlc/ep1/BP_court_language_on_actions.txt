# Fired when a character's court grandeur level changes
# root = character observing the change
# scope:target_character = character changing language
on_court_language_changed = {
	on_actions = { bp_court_language_on_actions }
}

bp_court_language_on_actions = {
	effect = {
		scope:target_character = {
			if = { #Update vassal court languages...
				limit = { #If we meet the requiresments (court language does *not* match the variable
					has_government = bureaucratic_government
					primary_title = { has_variable = court_language }
					NOT = { has_court_language_of_culture = primary_title.var:court_language }
				}
				every_held_title = {
					limit = { this.tier >= this.primary_title.tier }
					if = {
						limit = { has_variable = court_language }
						remove_variable = court_language
					}
					set_variable = {
						name = court_language
						value = scope:target_character.culture
					}
				}
				#And all the vassals
				every_vassal_or_below = {
					limit = {
						has_government = gubernatorial_government
						has_royal_court = yes
					}
					if = {
						limit = { NOT = { has_same_court_language = this.top_liege } }
						match_court_languages_effect = {
							TOP_COURT = this.top_liege
							CURRENT_COURT = this
						}
					}
				}
			}
		}
	}
}
